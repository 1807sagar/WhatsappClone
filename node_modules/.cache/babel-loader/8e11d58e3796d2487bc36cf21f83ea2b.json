{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\New folder\\\\WhatsappClone\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Avatar}from\"@material-ui/core\";import\"./SidebarChat.css\";import db from\"./firebase\";import{Link}from\"react-router-dom\";import{useStateValue}from\"./StateProvider\";import{actionTypes}from\"./reducer\";import AddCircleIcon from\"@material-ui/icons/AddCircle\";import DeleteForeverIcon from\"@material-ui/icons/DeleteForever\";import firebase from\"firebase\";import{password}from\"./constants\";function SidebarChat(props){var _messages$,_messages$2;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),seed=_useState2[0],setSeed=_useState2[1];var addNewChatVal=props.addNewChatVal,name=props.name,id=props.id;var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];var _useStateValue=useStateValue(),_useStateValue2=_slicedToArray(_useStateValue,2),togglerState=_useStateValue2[0].togglerState,dispatch=_useStateValue2[1];useEffect(function(){if(id){db.collection(\"rooms\").doc(id).collection(\"messages\").orderBy(\"timestamp\",\"desc\").onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return doc.data();}));});}},[]);useEffect(function(){setSeed(Math.floor(Math.random()*5000));},[]);var deleteRoom=function deleteRoom(){var passwordVerify=prompt(\"Enter Admin Password to delete Room\");if(passwordVerify==password){db.collection(\"rooms\").doc(id).delete().then(function(){window.location=\"/\";}).catch(function(error){console.error(\"Error removing document: \",error);});}else{alert(\"You are not authorised to delete rooms\");}};var createChat=function createChat(){var roomName=prompt(\"Please enter name for chat\");if(roomName&&roomName.length>=20){return alert(\"enter a shorter name for the room\");}if(roomName){db.collection(\"rooms\").add({name:roomName,timestamp:firebase.firestore.FieldValue.serverTimestamp()});}};var handleChat=function handleChat(){dispatch({type:actionTypes.SET_TOGGLER,togglerState:togglerState+1});};return addNewChatVal!==\"true\"?/*#__PURE__*/React.createElement(\"div\",{className:\"sidebarChat\"},/*#__PURE__*/React.createElement(Link,{to:\"/rooms/\".concat(id),onClick:handleChat},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebarChat__wrapper\"},/*#__PURE__*/React.createElement(Avatar,{src:\"https://avatars.dicebear.com/api/male/\".concat(seed,\".svg?background=%230000ff\")}),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebarChat__info\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"room__name\"},name),/*#__PURE__*/React.createElement(\"p\",{className:\"sidebar__lastmessages__color\"},/*#__PURE__*/React.createElement(\"span\",{className:\"sidebar__lastMessageName\"},id!=\"\"&&messages.length>0?((_messages$=messages[0])===null||_messages$===void 0?void 0:_messages$.name)+\": \":\"Loading: \"),id!=\"\"&&messages.length>0?(_messages$2=messages[0])===null||_messages$2===void 0?void 0:_messages$2.message:\"Start a new chat\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebarChat__delete\",onClick:deleteRoom},/*#__PURE__*/React.createElement(DeleteForeverIcon,null))):/*#__PURE__*/React.createElement(\"div\",{onClick:createChat,className:\"sidebarChat addnew__chat\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Add New Room\"),/*#__PURE__*/React.createElement(AddCircleIcon,null));}export default SidebarChat;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/New folder/WhatsappClone/src/SidebarChat.js"],"names":["React","useEffect","useState","Avatar","db","Link","useStateValue","actionTypes","AddCircleIcon","DeleteForeverIcon","firebase","password","SidebarChat","props","seed","setSeed","addNewChatVal","name","id","messages","setMessages","togglerState","dispatch","collection","doc","orderBy","onSnapshot","snapshot","docs","map","data","Math","floor","random","deleteRoom","passwordVerify","prompt","delete","then","window","location","catch","error","console","alert","createChat","roomName","length","add","timestamp","firestore","FieldValue","serverTimestamp","handleChat","type","SET_TOGGLER","message"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Avatar } from \"@material-ui/core\";\r\nimport \"./SidebarChat.css\";\r\nimport db from \"./firebase\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useStateValue } from \"./StateProvider\";\r\nimport { actionTypes } from \"./reducer\";\r\nimport AddCircleIcon from \"@material-ui/icons/AddCircle\";\r\nimport DeleteForeverIcon from \"@material-ui/icons/DeleteForever\";\r\nimport firebase from \"firebase\";\r\nimport { password } from \"./constants\";\r\nfunction SidebarChat(props) {\r\n  const [seed, setSeed] = useState(\"\");\r\n  const { addNewChatVal, name, id } = props;\r\n  const [messages, setMessages] = useState([]);\r\n  const [{ togglerState }, dispatch] = useStateValue();\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      db.collection(\"rooms\")\r\n        .doc(id)\r\n        .collection(\"messages\")\r\n        .orderBy(\"timestamp\", \"desc\")\r\n        .onSnapshot((snapshot) =>\r\n          setMessages(snapshot.docs.map((doc) => doc.data()))\r\n        );\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setSeed(Math.floor(Math.random() * 5000));\r\n  }, []);\r\n  const deleteRoom = () => {\r\n    const passwordVerify = prompt(\"Enter Admin Password to delete Room\");\r\n    if (passwordVerify == password) {\r\n      db.collection(\"rooms\")\r\n        .doc(id)\r\n        .delete()\r\n        .then(function () {\r\n          window.location = \"/\";\r\n        })\r\n        .catch(function (error) {\r\n          console.error(\"Error removing document: \", error);\r\n        });\r\n    } else {\r\n      alert(\"You are not authorised to delete rooms\");\r\n    }\r\n  };\r\n\r\n  const createChat = () => {\r\n    const roomName = prompt(\"Please enter name for chat\");\r\n    if (roomName && roomName.length >= 20) {\r\n      return alert(\"enter a shorter name for the room\");\r\n    }\r\n    if (roomName) {\r\n      db.collection(\"rooms\").add({\r\n        name: roomName,\r\n        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleChat = () => {\r\n    dispatch({\r\n      type: actionTypes.SET_TOGGLER,\r\n      togglerState: togglerState + 1,\r\n    });\r\n  };\r\n\r\n  return addNewChatVal !== \"true\" ? (\r\n    <div className=\"sidebarChat\">\r\n      <Link to={`/rooms/${id}`} onClick={handleChat}>\r\n        <div className=\"sidebarChat__wrapper\">\r\n          <Avatar src={`https://avatars.dicebear.com/api/male/${seed}.svg?background=%230000ff`} />\r\n          <div className=\"sidebarChat__info\">\r\n            <h2 className=\"room__name\">{name}</h2>\r\n            <p className=\"sidebar__lastmessages__color\">\r\n              <span className=\"sidebar__lastMessageName\">\r\n                {id != \"\" && messages.length > 0\r\n                  ? messages[0]?.name + \": \"\r\n                  : \"Loading: \"}\r\n              </span>\r\n              {id != \"\" && messages.length > 0\r\n                ? messages[0]?.message\r\n                : \"Start a new chat\"}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </Link>\r\n      <div className=\"sidebarChat__delete\" onClick={deleteRoom}>\r\n        <DeleteForeverIcon />\r\n      </div>\r\n    </div>\r\n  ) : (\r\n    <div onClick={createChat} className=\"sidebarChat addnew__chat\">\r\n      <h2>Add New Room</h2>\r\n      <AddCircleIcon />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SidebarChat;\r\n"]},"metadata":{},"sourceType":"module"}